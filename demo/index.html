<script server>
	let form = { name: undefined };
	if (req.method == 'POST') {
	  form = req.body;
	}

	let paragraphs = req.query.paragraphs ?? 10;

	return {
	  title: "Demo",
	  random: Math.random(),
	  lorem: await fetch(`https://loripsum.net/api/${paragraphs}`).then(r => r.text()),
	  form,
	}
</script>

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="bulma.min.css" />
		<title>${title}</title>
	</head>
	<body>
		<nav class="navbar is-primary mb-5">
			<div class="navbar-brand">
				<a class="navbar-item is-active" href="/">Home</a>
				<a class="navbar-item" href="/form">Example form</a>
			</div>
		</nav>

		<main class="container">
			<h1 class="title mb-5">Welcome to ${title}</h1>

			<hr class="my-5" />

			<h2 class="subtitle">Conditional rendering</h2>
			${ random > 0.5 ? 'Tail' : 'Head' }

			<hr class="my-5" />

			<h2 class="subtitle">List</h2>
			<ul>
				${[1, 2, 3, 4].map((i) => `
				<li>item ${i}</li>
				` ).join('')}
			</ul>

			<hr class="my-5" />

			<h2 class="subtitle">Here is some (server-side fetched) lorem ipsum :</h2>
			<p>
				You can add a
				<span class="is-family-monospace">?paragraphs=5</span> parameter in the
				url to change the number of rendered paragraphs
			</p>

			<section class="is-family-monospace mt-5 has-text-gray">${lorem}</section>
		</main>
	</body>
</html>
